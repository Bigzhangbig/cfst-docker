# 产品指南：cfst-docker

本文档概述了 `cfst-docker` 项目的产品愿景、目标、功能和设计原则。

## 1. 核心愿景与目标

`cfst-docker` 旨在提供一个轻量级、易于使用且高度自动化的 Docker 解决方案，用于运行 [CloudflareSpeedTest](https://github.com/XIU2/CloudflareSpeedTest) 工具。

主要目标包括：
- **简化部署与执行：** 使用户能够在任何支持 Docker 的环境中快速、轻松地部署和运行 CloudflareSpeedTest。
- **实现无人值守自动化：** 提供强大的自动化功能，特别是定时执行测速任务和自动记录结果，无需人工干预。

## 2. 目标用户与核心用例

此项目主要服务于两类用户：
- **个人用户：** 需要频繁测试 Cloudflare 节点以优化其网络连接的用户。
- **系统管理员：** 在服务器环境中寻求自动化网络监控和 IP 优化的专业人士。

核心用例是**通过轻量化容器快速执行测速，并自动将经过筛选的优质（最快且有速度）IP 同步至云端，以便于各种自动化脚本直接调用**。

## 3. 关键功能

为了实现上述目标，项目将具备以下关键功能：
- **定时任务 (Scheduled Jobs):** 内置支持定时运行测速任务，频率可由用户自定义。
- **参数化配置:** 允许用户通过环境变量或挂载的配置文件，灵活地自定义 CloudflareSpeedTest 的所有运行参数。
- **结果智能筛选与上传:** 支持将测速结果（仅保留有速度且延迟最低的前 20 条）自动同步到 GitHub Gist，极大地方便了后续引用。
- **多架构支持:** 构建并发布适用于多种 CPU 架构（如 `amd64` 和 `arm64`）的 Docker 镜像，以确保在主流服务器、PC 和 ARM 设备（如树莓派）上的兼容性。

## 4. 构建与发布

- **自动化构建:** 通过 GitHub Actions 实现完全自动化的 Docker 镜像构建和发布流程。
- **版本控制策略:** 镜像的版本号将遵循 `vX.X.X-Y` 的格式。其中，主版本号 (`vX.X.X`) 与上游 CloudflareSpeedTest 工具的版本号保持一致，子版本号 (`Y`) 用于表示 Docker 镜像自身的迭代更新（例如 `v2.2.4-1`, `v2.2.4-2`）。

## 5. 设计与实施原则

在开发过程中，我们将遵循以下原则：
- **轻量级镜像:** 优先选择最小化的基础镜像，并精简构建过程，以确保最终的 Docker 镜像尽可能小，从而减少下载时间和资源占用。
- **极致易用性:** 提供清晰、全面的文档，并设计一套合理的默认配置。目标是让新用户能够以最少的配置快速上手，实现“开箱即用”。